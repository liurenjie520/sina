<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<script src="./laydate.js">
	</script>
	<script src="./jquery-3.6.0.min.js" type="text/javascript">
	</script>
	<script>
		function bh() {
			//$('table tr:not(:first)').remove();
			var len = $('table tr').length;
			for(var i = 0; i <= len; i++) {
				$('table tr:eq(' + i + ') td:first').text(i);
			}

		}
	</script>
	<script>
		//执行一个laydate实例
		laydate.render({
			elem: '#laydate' //指定元素
				//,type: 'datetime'
				,
			format: 'yyyy/MM/dd'

		});

		laydate.render({
			elem: '#jk' //指定元素
				//,type: 'datetime'
				,
			type: 'time',
			format: 'HH'

		});
	</script>

	<body style="background-color:#FFF0CD;">
		<h2>
    在HTML中引用JavaScript的变量
    </h2>
		<hr>
		<br>
		<h5>单机相应的按钮……</h5>
		<form name="form1" method="post" action="">
			<label>
    <input type="text" name="textfield" id="textfield" style="width:560px;height:40px;background-color:#FFF0CD">
    <input type="button" style="width:150px;height:40px;background-color:#FFF0CD" name="button2" id="button2" value="当前时间生成url" onclick="javascript: void var2pass();">
    <input type="button" style="width:150px;height:40px;background-color:#FFF0CD" name="button" id="button" value="当前时间的热搜" onclick="javascript: void show(textfield.value);">
   
    
    
    </label>
			<!-- 绑定onclick事件 -->
			<label>
   <br />
      </label>
			<!-- 绑定onclick事件 -->
			<label>
				<input type="text" id="laydate" style="width:80px;height:40px;background-color:#FFF0CD"/>
    <input type="text" id="jk" style="width:80px;height:40px;background-color:#FFF0CD"/>
    <input type="text" id="createurl" style="width:560px;height:40px;background-color:#FFF0CD"/>
    
     <input type="button" name="button3" style="width:150px;height:40px;background-color:#FFF0CD" id="button3" value="自定义时间生成url" onclick="javascript: void gettime();">
     <input type="button" name="button" style="width:150px;height:40px;background-color:#FFF0CD" id="button" value="自定义时间的热搜" onclick="javascript: void show(createurl.value);">
 
    </label>
		</form>

		<!--<table width=500 border=2 id="firstTabOverall">
			<tr>
				<td width=250>序号</td>
				<td width=250>项目</td>
				<td width=250>项目</td>
			</tr>
			<tr >
				<td></td>
				<td id="rs">255</td>
				<td id="hot">255</td>
			</tr>
		</table>
    -->
		<table width="600" border="1" cellspacing="0">
			<thead>
				<tr>
					<th>排行</th>
					<th>名称</th>
					<th>热度值</th>

				</tr>
			</thead>
			<tbody id="tbMain"></tbody>

	</body>
	<script src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
	<script>
		var str_1 = '';

		function var2pass() {
			var mdate = new Date();
			//  	var c=mdate.toLocaleString()
			//  	var f=c.slice(0,10)

			d = String(mdate.getDate().toString().padStart(2, '0'))
			m = String((mdate.getMonth() + 1).toString().padStart(2, '0'))
			y = String(mdate.getFullYear())
			h = String(mdate.getHours().toString().padStart(2, '0'))
			lujing = y + '/' + m + '/' + d
			wenjian = '/' + y + m + d + h + '.json'
			zifu = "https://raw.githubusercontent.com/liurenjie520/weibohot/main/" + lujing
			urll = zifu + wenjian
			str_1 = urll.replace(/\s*/g, "");
			console.log(str_1)
			document.getElementById('textfield').value = str_1;
		}

		function gettime() {

			var gettime = document.getElementById('laydate').value
			var date = new Date(gettime)
			d = String(date.getDate().toString().padStart(2, '0'))
			m = String((date.getMonth() + 1).toString().padStart(2, '0'))
			y = String(date.getFullYear())
			var hour = document.getElementById('jk').value
			lujing = y + '/' + m + '/' + d
			wenjian = '/' + y + m + d + hour + '.json'
			zifu = "https://raw.githubusercontent.com/liurenjie520/weibohot/main/" + lujing
			urll = zifu + wenjian
			str_2 = urll.replace(/\s*/g, "")
			console.log(str_2)
			document.getElementById('createurl').value = str_2;

		}
		
		
		
		
		

		function show(dd) {
			$.ajax({
				url: dd, //json文件位置
				type: "GET", //请求方式为get
				dataType: "json", //返回数据格式为json
				success: function(data) { //请求成功完成后要执行的方法 
					//each循环 使用$.each方法遍历返回的数据date
					$.each(data, function(i, item) {

						//                  var str =  '<table width=500 border=2><tr><td width=250>序号</td><td width=250>项目</td><td width=250>项目</td></tr><tr><td></td><td>'+ i +'</td><td>'+ item.hot + '</td></tr></table>'
						//;                   
						//                  document.write(str);

						var biaoti = i
						console.log(biaoti)
						var hot = item.hot
						
						//                  document.getElementById('rs').innerHTML= biaoti;
						//                  var tbody = document.getElementById('tbMain');
						//                  var row = document.createElement('tr');
						//                  var idCell = document.createElement('td');
						//                  idCell.innerHTML = biaoti;
						//                  var tbody = document.getElementById("tbMain");
						//                  tbody.appendChild(row)
						

						var tbody = document.getElementById('tbMain');

//						for(var j = 0; j < item.length; j++) { //遍历一下json数据
						var trow = getDataRow(); //定义一个方法,返回tr数据
						tbody.appendChild(trow);
//						}
						
						function getDataRow(){

						var row = document.createElement('tr'); //创建行

						var idCell = document.createElement('td'); //创建第一列id
						idCell.innerHTML = bh(); //填充数据
						row.appendChild(idCell); //加入行  ，下面类似
						var nameCell = document.createElement('td'); //创建第二列name
						nameCell.innerHTML = biaoti;
						row.appendChild(nameCell);

						var jobCell = document.createElement('td'); //创建第三列job
						jobCell.innerHTML = hot;
						row.appendChild(jobCell);
						return row; //返回tr数据	
						}

					})
				}
			})
		}
	</script>

</html>
